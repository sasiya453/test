<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Obscura Vault - Courses</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="selenix.css">
  <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

  <style>
    .player-wrap { 
      max-width: 1100px; 
      margin: 0 auto; 
      padding: 0 15px;
    }
    
    .player-shell {
      position: relative;
      width: 100%;
      background: #000;
      border-radius: 14px;
      overflow: hidden;
      box-shadow: 0 8px 24px rgba(0,0,0,.35);
      aspect-ratio: 16/9;
      user-select: none;
      -webkit-user-select: none;
    }
    
    /* Mobile adjustments for player shell */
    @media (max-width: 768px) {
      .player-shell {
        border-radius: 8px;
        aspect-ratio: 16/9;
      }
      
      /* Hide volume slider on mobile */
      .volume-slider {
        display: none !important;
      }
      
      /* Show fullscreen button on mobile */
      #fsBtn {
        display: inline-flex !important;
      }
      
      /* Hide landscape button on mobile */
      #lsBtn {
        display: none !important;
      }
      
      /* HIDE PLAYBACK SPEED ON MOBILE BY DEFAULT */
      .speed {
          display: none !important;
      }
    }
    
    /*Watermark Image*/
    .ov-watermark1 {
      position: absolute;
      bottom: 10px;  /* distance from bottom */
      right: 10px;   /* distance from right */
      pointer-events: none;
      opacity: 0.18; /* overall transparency */
      mix-blend-mode: difference; /* adapts to light/dark backgrounds */
      width: 100px;  /* set square size */
      height: 100px; /* same as width */
      overflow: hidden; /* ensures image stays within the square */
      z-index: 3;
    }

    .ov-watermark1 img {
      width: 100%;
      height: 100%;
      object-fit: cover; /* crops image to fill square */
      filter: invert(1); /* inverts colors: white → black */
      opacity: 0.6;      /* fine-tune visibility */
    }

    /* Watermark */
    .ov-watermark {
      position: absolute;
      inset: 0;
      pointer-events: none;
      display: grid;
      place-items: center;
      opacity: .18;
      mix-blend-mode: darken;
      font-weight: 700;
      color: #00f;
      text-transform: uppercase;
      letter-spacing: 4px;
      font-size: clamp(16px, 5vw, 42px);
      background-image:
        repeating-linear-gradient(
          -30deg,
          rgba(0,0,255,.12) 0 40px,
          rgba(0,0,255,.15) 40px 80px
        );
      z-index: 3;
    }
    
    .ov-watermark span {
      text-shadow: 0 1px 0 rgba(0,0,0,.8);
    }
    
    /* The actual YouTube host container */
    .yt-host, .yt-iframe {
      position: absolute; 
      inset: 0; 
      width: 100%; 
      height: 100%;
    }
    
    .yt-iframe { 
      border: 0; 
    }

    /* Transparent layer that blocks direct interaction with iframe */
    .anti-iframe {
      position: absolute; 
      inset: 0; 
      width: 100%; 
      height: 100%;
      z-index: 4;
      background: transparent;
    }

    /* Controls bar */
    .controls {
      position: absolute;
      left: 0; 
      right: 0; 
      bottom: 0;
      z-index: 5;
      display: grid;
      gap: 8px;
      padding: 10px 12px;
      background: linear-gradient(to top, rgba(0,0,0,.75), rgba(0,0,0,.0));
      transition: opacity 0.3s ease;
    }
    
    /* Hide controls when not interacting on mobile */
    @media (max-width: 768px) {
      .player-shell:not(:hover) .controls {
        opacity: 0;
        pointer-events: none;
      }
      
      .player-shell:hover .controls {
        opacity: 1;
      }
      
      /* Hide volume controls in normal mobile view */
      .volume-control {
        display: none;
      }
    }
    
    .row {
      display: flex; 
      align-items: center; 
      gap: 10px;
    }
    
    .btn1, .icon {
      appearance: none; 
      border: 0; 
      outline: 0;
      background: rgba(0,0,0,1);
      color: #fff; 
      padding: 8px 12px; 
      border-radius: 12px;
      font-size: 14px; 
      line-height: 1; 
      cursor: pointer;
      display: inline-flex; 
      align-items: center; 
      gap: 8px;
      backdrop-filter: blur(6px);
    }
    
    .btn1:hover, .icon:hover { 
      background: rgba(255,255,255,.18); 
      color: #000; 
      padding: 8px 12px; 
      border-radius: 12px;
    }
    
    .btn1:active, .icon:active { 
      transform: translateY(1px); 
    }    

    .btn, .icon {
      appearance: none; 
      border: 0; 
      outline: 0;
      background: rgba(255,255,255,.12);
      color: #fff; 
      padding: 8px 12px; 
      border-radius: 12px;
      font-size: 14px; 
      line-height: 1; 
      cursor: pointer;
      display: inline-flex; 
      align-items: center; 
      gap: 8px;
      backdrop-filter: blur(6px);
    }
    
    .btn:hover, .icon:hover { 
      background: rgba(255,255,255,.18); 
    }
    
    .btn:active, .icon:active { 
      transform: translateY(1px); 
    }

    /* Time + seek */
    .time {
      color: #fff; 
      font-variant-numeric: tabular-nums; 
      font-size: 13px; 
      opacity: .9;
      min-width: 110px; 
      text-align: center;
    }
    
    .seek {
      flex: 1 1 auto;
      display: flex; 
      align-items: center; 
      gap: 10px;
      min-width: 120px;
    }
    
    .seek input[type="range"] {
      -webkit-appearance: none; 
      appearance: none; 
      width: 100%;
      height: 6px; 
      border-radius: 999px;
      background: rgba(255,255,255,.3); 
      outline: none;
    }
    
    .seek input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none; 
      appearance: none;
      width: 14px; 
      height: 14px; 
      border-radius: 50%;
      background: #fff; 
      cursor: pointer; 
      box-shadow: 0 0 0 3px rgba(0,0,0,.2);
    }
    
    .seek input[type="range"]::-moz-range-thumb {
      width: 14px; 
      height: 14px; 
      border-radius: 50%;
      background: #fff; 
      cursor: pointer; 
      box-shadow: 0 0 0 3px rgba(0,0,0,.2);
    }
    
    /* Volume control */
    .volume-control {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .volume-slider {
      -webkit-appearance: none;
      appearance: none;
      width: 80px;
      height: 6px;
      border-radius: 999px;
      background: rgba(255,255,255,.3);
      outline: none;
    }
    
    .volume-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 14px;
      height: 14px;
      border-radius: 50%;
      background: #fff;
      cursor: pointer;
      box-shadow: 0 0 0 3px rgba(0,0,0,.2);
    }
    
    .volume-slider::-moz-range-thumb {
      width: 14px;
      height: 14px;
      border-radius: 50%;
      background: #fff;
      cursor: pointer;
      box-shadow: 0 0 0 3px rgba(0,0,0,.2);
    }
    
    /* Mobile adjustments for controls */
    @media (max-width: 768px) {
      .controls {
        padding: 8px 10px;
      }
      
      .btn, .btn1, .icon {
        padding: 6px 10px;
        font-size: 12px;
      }
      
      .time {
        font-size: 11px;
        min-width: 90px;
      }
      
      .seek input[type="range"] {
        height: 5px;
      }
      
      .seek input[type="range"]::-webkit-slider-thumb {
        width: 12px;
        height: 12px;
      }
      
      .speed {
        padding: 6px 8px;
        font-size: 12px;
      }
      
      .volume-slider {
        width: 60px;
        height: 5px;
      }
      
      .volume-slider::-webkit-slider-thumb {
        width: 12px;
        height: 12px;
      }
      
      /* Hide text labels on mobile to save space */
      .icon span {
        display: none;
      }
      
      .right {
        gap: 6px;
      }
    }

    /* Right-side controls */
    .right { 
      margin-left: auto; 
      display: flex; 
      align-items: center; 
      gap: 8px; 
    }
    
    .speed {
      background: rgba(255,255,255,.12);
      color: #fff; 
      border-radius: 12px; 
      padding: 8px 10px; 
      border: 0;
    }

    /* Mobile tap area improvements */
    @media (max-width: 768px) {
      .icon, .btn, .btn1 {
        min-height: 36px;
        min-width: 36px;
        justify-content: center;
      }
    }

    /* Fullscreen styles */
    .player-shell:fullscreen {
      width: 100%;
      height: 100%;
      border-radius: 0;
      max-width: none;
    }
    
    .player-shell:-webkit-full-screen {
      width: 100%;
      height: 100%;
      border-radius: 0;
      max-width: none;
    }
    
    .player-shell:-moz-full-screen {
      width: 100%;
      height: 100%;
      border-radius: 0;
      max-width: none;
    }
    
    .player-shell:-ms-fullscreen {
      width: 100%;
      height: 100%;
      border-radius: 0;
      max-width: none;
    }
    
    /* Prevent image/element dragging */
    img, .player-shell, .anti-iframe { 
      -webkit-user-drag: none; 
    }
    
    /* Back button row */
    .back-row {
      margin-bottom: 15px;
    }
    
    .back-row button {
      background: rgba(255,255,255,.1);
      border: none;
      color: #fff;
      padding: 8px 16px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
    }
    
    /* Player CTA buttons */
    .player-cta {
      margin-top: 15px;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    
    @media (max-width: 768px) {
      .player-cta {
        flex-direction: column;
      }
      
      .player-cta .btn1 {
        width: 100%;
        text-align: center;
        justify-content: center;
      }
    }
    
    /* Related cards */
    .cards {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    
    @media (max-width: 768px) {
      .cards {
        grid-template-columns: 1fr;
        gap: 15px;
      }
    }
    
    /* No JavaScript warning */
    .no-js-message {
      display: none;
      text-align: center;
      padding: 2rem;
      background: #f8d7da;
      color: #721c24;
      border-radius: 8px;
      margin: 2rem 0;
    }
    
    .no-js .no-js-message {
      display: block;
    }
    
    .no-js .player-shell,
    .no-js .player-cta,
    .no-js .cards {
      display: none;
    }

    /* New Player Styles */
    .gfg {
        padding-bottom: 10px;
        display: flex;
        justify-content: space-around;
        flex-direction: column;
        font-size: 24px;
        font-weight: 600;
        color: #01940b;
        align-items: center;
    }

    .video-container {
        max-width: 1100px;
        width: 100%;
        position: relative;
        border: 1px;
        border-style: ridge;
        margin: 0 auto;
        background-color: black;
        aspect-ratio: 16/9;
    }

    #video-thumbnail {
        position: absolute;
        width: 100%;
        height: 100%;
        object-fit: cover;
        cursor: pointer;
    }

    #video,
    img#video-thumbnail {
        width: 100%;
        height: 100%;
    }

    .controls {
        position: absolute;
        bottom: 0px;
        left: 0;
        right: 0;
        height: 40px;
        background-color: rgba(
            0,
            0,
            0,
            0.7
        );
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px;
        opacity: 0;
        transition: opacity 0.3s ease-in-out;
    }

    .controls button {
        background-color: transparent;
        border: none;
        color: #fff;
        font-size: 20px;
        cursor: pointer;
        outline: none;
    }

    .left {
        position: relative;
        top: 1%;
        width: 70px;
        display: flex;
        justify-content: space-between;
    }

    .video-timer {
        position: relative;
        top: 5.2px;
        right: 6px;
        display: flex;
        flex-direction: row;
        color: #efefef;
        margin-left: 15px;
        font-size: 12px;
    }

    #separator {
        margin: 0 5px;
        font-size: 16px;
        font-family: "Open sans";
    }

    .right {
        position: relative;
        padding: 10px;
        top: 1.5px;
    }

    .fa-volume-up,
    .fa-solid {
        font-size: small;
        padding: 5px;
        color: rgb(255, 255, 255);
    }

    button,
    input {
        background-color: transparent;
        border: none;
        cursor: pointer;
        font-size: 20px;
    }

    .volume-container {
        display: flex;
        align-items: center;
    }

    #volume {
        position: relative;
        left: 5px;
        width: 50px;
        height: 3px;
    }

    #mute {
        cursor: pointer;
    }

    .playback-line {
        position: relative;
        top: 2.7px;
        height: 4px;
        background-color: #ddd;
        width: 40%;
        cursor: pointer;
    }

    .progress-bar {
        height: 100%;
        width: 0;
        background-color: #0078d4;
        transition: width 0.1s linear;
    }
  </style>
</head>
<body class="no-js">
  <div class="no-js-message">
    <h2>JavaScript Required</h2>
    <p>This page requires JavaScript to function properly. Please enable JavaScript in your browser settings.</p>
  </div>

  <header class="header">
    <div class="container nav">
      <a class="brand" href="index.html">
        <img alt="selenix logo">
        <div class="logo-text">Obscura Vault</div>
      </a>
      <nav class="nav-links">
        <a href="index.html">Home</a>
        <a href="index.html#about">About</a>
        <a href="lessons.html">Lessons</a>
        <a href="index.html#contact">Contact</a>
        <button class="icon-btn" data-open-search aria-label="Search">
          <img class="search-icon" src="https://cdn-icons-png.flaticon.com/128/3686/3686896.png" alt="Search" loading="lazy" decoding="async">
        </button>
      </nav>
      <button class="icon-btn hamburger" aria-label="Menu"><span></span><span></span><span></span></button>
    </div>
    <div class="mobile-drawer">
      <a href="index.html">Home</a>
      <a href="index.html#about">About</a>
      <a href="lessons.html">Lessons</a>
      <a href="index.html#contact">Contact</a>
      <a href="#" data-open-search>Search</a>
    </div>
    <div class="mobile-searchbar">
      <form id="mobileSearchForm">
        <input id="mobileSearch" placeholder="Search lessons...">
        <button type="submit">Search</button>
      </form>
    </div>
  </header>

  <div class="search-overlay" id="searchOverlay">
    <div class="search-card">
      <h3>Search lessons</h3>
      <div class="search-row">
        <input id="globalSearchInput" placeholder="Type keyword...">
        <button id="globalSearchGo">Search</button>
      </div>
    </div>
  </div>

  <div class="container player-wrap">
    <div class="back-row">
      <button data-back>← Back</button>
    </div>

    <h2 id="playerTitle">Loading...</h2>

    <div class="video-container">
        <img src="https://media.geeksforgeeks.org/wp-content/uploads/20231020170918/Thumbnail-(1).jpg" id="video-thumbnail">
        <video id="video">
            <source src="https://media.geeksforgeeks.org/wp-content/uploads/20231020155223/Full-Stack-Development-_-LIVE-Classes-_-GeeksforGeeks.mp4" type="video/mp4">
        </video>
        <div class="controls">
            <div class="left">
                <button id="skipminus-10">
                    <i class="fa-solid fa-backward"></i>
                </button>
                <button id="play-pause">
                    <i class="fa-solid fa-play"></i>
                </button>
                <button id="skip-10">
                    <i class="fa-solid fa-forward"></i>
                </button>
            </div>
            <div class="video-timer">
                <span id="current-time">00:00</span>
                <span id="separator">/</span>
                <span id="max-duration">00:00</span>
            </div>
            <div class="playback-line">
                <div class="progress-bar"></div>
            </div>
            <div class="right">
                <div class="volume-container">
                    <div id="mute">
                        <i class="fas fa-volume-up"></i>
                    </div>
                    <input type="range" id="volume" min="0" max="1" step="0.01" value="1">
                </div>
            </div>
        </div>
    </div>


    <div class="player-cta" style="margin-top:10px">
      <a class="btn1" id="telegramBtn" target="_blank">Terms and Conditions</a>
      <a class="btn1 secondary" id="resourceBtn" target="_blank">Access PDF</a>
    </div>

    <div class="bar" style="margin:20px 0 16px"></div>
    <h3>Other parts in this lesson</h3>
    <div class="cards" id="relatedCards"></div>
  </div>

  <footer class="footer">
    <div class="footer-top-art"></div>
    <div class="container">
      <div class="footer-inner" style="grid-column:1/-1;display:flex;flex-direction:column;align-items:center;text-align:center;gap:18px;padding-top:10px;padding-bottom:50px">
        <div class="footer-social" style="display:flex;gap:18px">
          <a href="https://t.me/ObscuraVaulfOfficial" target="_blank" aria-label="Telegram" title="Telegram"
             style="width:44px;height:44px;border-radius:50%;background:#fff;color:#111;display:inline-flex;align-items:center;justify-content:center;font-size:26px;text-decoration:none">
            <i class='bx bxl-telegram'></i>
          </a>
          <a href="https://www.youtube.com/@ObscuraVault-Official" target="_blank" aria-label="YouTube" title="YouTube"
             style="width:44px;height:44px;border-radius:50%;background:#fff;color:#111;display:inline-flex;align-items:center;justify-content:center;font-size:26px;text-decoration:none">
            <i class='bx bxl-youtube'></i>
          </a>
        </div>
        <nav class="footer-menu" style="display:flex;gap:26px;flex-wrap:wrap;justify-content:center">
          <a href="index.html" style="color:#eaeaea;text-decoration:none">Home</a>
          <a href="index.html#about" style="color:#eaeaea;text-decoration:none">About</a>
          <a href="lessons.html" style="color:#eaeaea;text-decoration:none">Lessons</a>
          <a href="index.html#contact" style="color:#eaeaea;text-decoration:none">Contact</a>
        </nav>
        <div class="footer-copy" style="font-size:13px;color:#bdbdbd">© 2025 Obscura Vault. All Rights Reserved</div>
      </div>
    </div>
  </footer>

  <script src="selenix.js"></script>

  <script>
  // Remove no-js class if JavaScript is enabled
  document.body.classList.remove('no-js');
  
  // ---- Security Measures ----
  // Disable right-click context menu
  document.addEventListener('contextmenu', function(e) {
    e.preventDefault();
    return false;
  });
  
  // Disable text selection
  document.addEventListener('selectstart', function(e) {
    e.preventDefault();
    return false;
  });
  
  // Disable drag and drop
  document.addEventListener('dragstart', function(e) {
    e.preventDefault();
    return false;
  });
  
  // Disable developer tools (F12, Ctrl+Shift+I, etc.)
  document.addEventListener('keydown', function(e) {
    // Disable F12
    if (e.key === 'F12') {
      e.preventDefault();
      return false;
    }
    
    // Disable Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+Shift+C, Ctrl+U
    if (e.ctrlKey && e.shiftKey && ['I', 'J', 'C'].includes(e.key)) {
      e.preventDefault();
      return false;
    }
    
    // Disable Ctrl+U (view source)
    if (e.ctrlKey && e.key === 'u') {
      e.preventDefault();
      return false;
    }
    
    // Block common "save/open" combos
    if ((e.ctrlKey || e.metaKey) && ['s','u','p','o'].includes(e.key.toLowerCase())) {
      e.preventDefault();
      return false;
    }
  });
  
  // Detect if dev tools are open (basic detection)
  setInterval(function() {
    const widthThreshold = window.outerWidth - window.innerWidth > 160;
    const heightThreshold = window.outerHeight - window.innerHeight > 160;
    const orientation = widthThreshold ? 'vertical' : 'horizontal';
    
    if (!(heightThreshold && widthThreshold) &&
        ((window.Firebug && window.Firebug.chrome && window.Firebug.chrome.isInitialized) || 
         widthThreshold || heightThreshold)) {
      // Dev tools detected - redirect or show warning
      document.body.innerHTML = '<div style="padding: 20px; text-align: center;"><h2>Developer Tools Detected</h2><p>Please close developer tools to continue using this site.</p></div>';
      window.stop();
    }
  }, 1000);
  
  // ---- State ----
  const state = { items:[], current:null, group:null, subjects:[], colors:{}, player:null, apiReady:false, tick:null, seeking:false, isMobileFullscreen: false };

  // Basic route helpers
  function getRID(){ return new URLSearchParams(location.search).get('rid'); }

  // Extract a YouTube videoId from common URL formats
  function extractYouTubeID(urlOrId){
    if (!urlOrId) return null;
    // already an 11-char ID
    if (/^[a-zA-Z0-9_-]{11}$/.test(urlOrId)) return urlOrId;

    try {
      const u = new URL(urlOrId);
      if (u.hostname.includes('youtu.be')) return u.pathname.slice(1);
      if (u.searchParams.get('v')) return u.searchParams.get('v');
      // embed or short formats
      const m = u.pathname.match(/\/(embed|shorts|live)\/([a-zA-Z0-9_-]{11})/);
      if (m) return m[2];
    } catch {}
    // fallback: try to pull last 11 id-like chars
    const m2 = String(urlOrId).match(/([a-zA-Z0-9_-]{11})(?:[^a-zA-Z0-9_-]|$)/);
    return m2 ? m2[1] : null;
  }

  // Format time as mm:ss or hh:mm:ss
  function fmt(seconds){
    seconds = Math.max(0, Math.floor(seconds||0));
    const h = Math.floor(seconds/3600);
    const m = Math.floor((seconds%3600)/60);
    const s = seconds%60;
    if (h>0) return `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
    return `${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
  }

  // UI node refs
  const $ = sel => document.querySelector(sel);
  const $$ = sel => document.querySelectorAll(sel);

  // Render page
  function renderPlayer(){
    const t = document.getElementById('playerTitle');
    if (!state.current){ t.textContent='Not found'; return; }

    t.textContent = `${state.current.lesson} — ${state.current.partTitle}`;

    // Buttons
    const tg = document.getElementById('telegramBtn');
    const rs = document.getElementById('resourceBtn');
    tg.href = state.current.telegram || '#';
    rs.href = state.current.resource || '#';

    // Related parts
    const rel = document.getElementById('relatedCards');
    rel.innerHTML = '';
    if (state.group){
      state.group.parts.forEach(p=>{
        const card = document.createElement('div'); card.className='card';
        const img = document.createElement('img'); img.src = p.thumb || ''; img.alt = p.partTitle || 'thumbnail';
        card.appendChild(img);
        const body = document.createElement('div'); body.className='card-body';
        const tag = document.createElement('div'); tag.className='tag-row';
        const dot = document.createElement('span'); dot.className='dot'; dot.style.setProperty('--subject-color', state.colors[state.group.subject]||'#000');
        tag.appendChild(dot);
        tag.appendChild(document.createTextNode(`${state.group.subject}`));
        const h4 = document.createElement('h4'); h4.textContent = p.partTitle || '';
        const desc = document.createElement('p'); desc.textContent = p.description || '';
        const actions = document.createElement('div'); actions.className='card-actions';
        const open = document.createElement('button'); open.className='btn1'; open.textContent = (p.id === state.current.id) ? 'Now Playing' : 'Play';
        open.disabled = (p.id === state.current.id);
        open.addEventListener('click', ()=>window.location.href=`player.html?rid=${encodeURIComponent(p.id)}`);
        actions.appendChild(open);
        body.appendChild(tag); body.appendChild(h4); body.appendChild(desc); body.appendChild(actions);
        card.appendChild(body);
        rel.appendChild(card);
      });
    }
  }

  // Boot
  async function boot(){
    selenix.initHeader();

    // Back button functionality
    document.querySelector('[data-back]').addEventListener('click', () => {
      window.history.back();
    });

    try {
      state.items = await selenix.fetchSheet();
      state.subjects = selenix.uniqueSubjects(state.items);
      state.colors = selenix.subjectColorMap(state.subjects);
      const rid = getRID();
      state.current = state.items.find(x=>x.id===rid);
      if (state.current){
        const groups = selenix.groupByLesson(state.items);
        state.group = groups.find(g=>g.subject===state.current.subject && g.lesson===state.current.lesson);
      }
      renderPlayer();

      const video = document.getElementById("video");
      const videoThumbnail = document.getElementById("video-thumbnail");
      if (state.current && state.current.youtube) {
          const videoSource = document.querySelector("#video > source");
          videoSource.setAttribute("src", state.current.youtube);
          video.load();
      }
       if (state.current && state.current.thumb) {
        videoThumbnail.src = state.current.thumb;
      }


    } catch (e){
      console.error(e);
      document.getElementById('playerTitle').textContent = 'Failed to load player.';
    }
  }
  
  boot();
  </script>

  <script>
    const video = document.getElementById("video");
    const videoThumbnail = document.getElementById("video-thumbnail");
    const playpause = document.getElementById("play-pause");
    const frwd = document.getElementById("skip-10");
    const bkwrd = document.getElementById("skipminus-10");
    const volume = document.getElementById("volume");
    const mutebtn = document.getElementById("mute");
    const videoContainer = document.querySelector(".video-container");
    const controls = document.querySelector(".controls");
    const progressBar = document.querySelector(".progress-bar");
    const playbackline = document.querySelector(".playback-line");
    const currentTimeRef = document.getElementById("current-time");
    const maxDuration = document.getElementById("max-duration");

    const timeFormatter = (timeInput) => {
        let minute = Math.floor(timeInput / 60);
        minute = minute < 10 ? "0" + minute : minute;
        let second = Math.floor(timeInput % 60);
        second = second < 10 ? "0" + second : second;
        return `${minute}:${second}`;
    };

    playpause.addEventListener("click", function () {
        if (video.paused) {
            videoThumbnail.style.display = "none";
            video.play();
            playpause.innerHTML = '<i class="fa-solid fa-pause"></i>';
        } else {
            video.pause();
            playpause.innerHTML = '<i class="fa-solid fa-play"></i>';
        }
    });

    let isPlaying = false;

    function togglePlayPause() {
        if (isPlaying) {
            video.pause();
            playpause.innerHTML = '<i class="fa-solid fa-play"></i>';
        } else {
            videoThumbnail.style.display = "none";
            video.play();
            playpause.innerHTML = '<i class="fa-solid fa-pause"></i>';
        }
        isPlaying = !isPlaying;
    }

    document.addEventListener("keydown", function (event) {
        if (event.keyCode === 32 || event.key === " ") {
            event.preventDefault();
            togglePlayPause();
        }
    });

    video.addEventListener("play", function () {
        isPlaying = true;
    });

    video.addEventListener("pause", function () {
        isPlaying = false;
    });

    video.addEventListener("ended", function () {
        playpause.innerHTML = '<i class="fa-solid fa-play"></i>';
    });

    frwd.addEventListener("click", function () {
        video.currentTime += 5;
    });
    bkwrd.addEventListener("click", function () {
        video.currentTime -= 5;
    });

    mutebtn.addEventListener("click", function () {
        if (video.muted) {
            video.muted = false;
            mutebtn.innerHTML = '<i class="fas fa-volume-up"></i>';
            volume.value = video.volume;
        } else {
            video.muted = true;
            mutebtn.innerHTML = '<i class="fa-solid fa-volume-xmark"></i>';
            volume.value = 0;
        }
    });

    document.addEventListener("keydown", function (event) {
        if (event.key === "M" || event.key === "m") {
            event.preventDefault();
            if (video.muted) {
                video.muted = false;
                mutebtn.innerHTML = '<i class="fas fa-volume-up"></i>';
                volume.value = video.volume;
            } else {
                video.muted = true;
                mutebtn.innerHTML = '<i class="fa-solid fa-volume-xmark"></i>';
                volume.value = 0;
            }
        }
    });

    volume.addEventListener("input", function () {
        video.volume = volume.value;
        if (video.volume === 0) {
            mutebtn.innerHTML = '<i class="fa-solid fa-volume-xmark"></i>';
        } else {
            mutebtn.innerHTML = '<i class="fas fa-volume-up"></i>';
        }
    });

    videoContainer.addEventListener("mouseenter", () => {
        controls.style.opacity = 1;
    });

    videoContainer.addEventListener("mouseleave", () => {
        controls.style.opacity = 0;
    });

    video.addEventListener("timeupdate", () => {
        const currentTime = video.currentTime;
        const duration = video.duration;
        const percentage = (currentTime / duration) * 100;
        progressBar.style.width = percentage + "%";
    });

    function showThumbnail() {
        videoThumbnail.style.display = "block";
    }

    video.addEventListener("ended", () => {
        progressBar.style.width = "0%";
        showThumbnail();
    });

    setInterval(() => {
        currentTimeRef.innerHTML = timeFormatter(video.currentTime);
        if (video.duration) {
            maxDuration.innerText = timeFormatter(video.duration);
        }
    }, 1);

    playbackline.addEventListener("click", (e) => {
        let timelineWidth = playbackline.clientWidth;
        video.currentTime = (e.offsetX / timelineWidth) * video.duration;
    });
  </script>
</body>
</html>
